# PROJECT.md ‚Äî Sofia Bot (Hybrid System)

> –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞. –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –í–°–Å –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã.
> –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-12-29

---

## ü§ñ CLAUDE: –°–¢–ê–†–¢ –°–ï–°–°–ò–ò

### 1. –ü—Ä–æ—á–∏—Ç–∞–π HANDOFF (–≤–Ω–∏–∑—É –¥–æ–∫—É–º–µ–Ω—Ç–∞)

### 2. –ó–∞–≥—Ä—É–∑–∏ –∫–æ–¥ (raw —Å—Å—ã–ª–∫–∏)

**–ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–æ—Å–Ω–æ–≤–Ω–∞—è):**
```
https://raw.githubusercontent.com/semiekhin/sofia-bot/main/sofia_hybrid.py
https://raw.githubusercontent.com/semiekhin/sofia-bot/main/bot_server_hybrid.py
https://raw.githubusercontent.com/semiekhin/sofia-bot/main/sofia_prompt.py
```

**–°–∫—Ä–∏–ø—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–∞–ª–æ–≥–æ–≤:**
```
https://raw.githubusercontent.com/semiekhin/sofia-bot/main/scripts/dialog_processor.py
https://raw.githubusercontent.com/semiekhin/sofia-bot/main/scripts/batch_process.py
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
```
https://raw.githubusercontent.com/semiekhin/sofia-bot/main/DEV_STANDARD.md
```

### 3. –°–∫–∞–∂–∏
"–ò–∑—É—á–∏–ª PROJECT.md –∏ –∫–æ–¥. [–°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ HANDOFF]. –ß—Ç–æ –¥–µ–ª–∞–µ–º?"

### –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞
| –ö–æ–º–∞–Ω–¥–∞ | –î–µ–π—Å—Ç–≤–∏–µ |
|---------|----------|
| `–∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä—É–µ–º` | –û–±–Ω–æ–≤–∏—Ç—å PROJECT.md ‚Üí commit ‚Üí push |
| `–ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–æ–≤—ã–π —á–∞—Ç` | –ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è + –≤—ã–¥–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ PROJECT.md |

---

## üìã QUICK INFO

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–ü—Ä–æ–µ–∫—Ç** | Sofia Bot ‚Äî AI-–ø—Ä–æ–¥–∞–∂–Ω–∏–∫ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ |
| **–ö–æ–º–ø–∞–Ω–∏—è** | Oazis Estate |
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | –ì–∏–±—Ä–∏–¥–Ω–∞—è: –∫–æ–¥ (–ª–æ–≥–∏–∫–∞) + LLM (—Ç–µ–∫—Å—Ç) |
| **–°—Ç–µ–∫** | Python 3.12, python-telegram-bot, OpenAI GPT-5.2, SQLite |
| **–í–µ—Ä—Å–∏—è** | 2.1 (hybrid) |
| **–°—Ç–∞—Ç—É—Å** | ‚úÖ Production |

### –°—Å—ã–ª–∫–∏

| –†–µ—Å—É—Ä—Å | URL |
|--------|-----|
| **GitHub** | https://github.com/semiekhin/sofia-bot |
| **–°–µ—Ä–≤–µ—Ä** | `ssh -p 2222 root@72.56.64.91` |
| **–ë–æ—Ç (hybrid)** | @humanAINeural_bot |
| **–ë–æ—Ç (claude A/B)** | @humanClaudeAINeural_bot |

### –°–µ—Ä–≤–∏—Å—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

| –°–µ—Ä–≤–∏—Å | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è | –°—Ç–∞—Ç—É—Å |
|--------|------------|--------|
| `sofia-hybrid` | /opt/sofia-hybrid/ | üü¢ ACTIVE (gpt-5.2-reasoning) |
| `sofia-bot` | /opt/sofia-bot/ | üî¥ STOPPED |
| `sofia-claude` | ‚Äî | üü¢ ACTIVE |

---

## üîê –°–ï–ö–†–ï–¢–´

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `/opt/sofia-hybrid/.env`

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|
| `OPENAI_API_KEY` | API –∫–ª—é—á OpenAI |
| `TELEGRAM_BOT_TOKEN` | –¢–æ–∫–µ–Ω –±–æ—Ç–∞ |
| `ADMIN_CHAT_ID` | 512319063 |

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê (HYBRID v2.1)

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è
**–ü—Ä–æ–±–ª–µ–º–∞:** LLM –Ω–µ —É–º–µ–µ—Ç —Å—á–∏—Ç–∞—Ç—å –∏ —Å–ª–µ–¥–æ–≤–∞—Ç—å –∂—ë—Å—Ç–∫–∏–º –ø—Ä–∞–≤–∏–ª–∞–º.
**–†–µ—à–µ–Ω–∏–µ:** –ö–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –ª–æ–≥–∏–∫—É, LLM —Ç–æ–ª—å–∫–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç.
```
–°–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
       ‚Üì
–ö–û–î: analyze_history() ‚Üí —Å—á—ë—Ç—á–∏–∫–∏
       ‚Üì
–ö–û–î: decide_action() ‚Üí –ñ–Å–°–¢–ö–ê–Ø –õ–û–ì–ò–ö–ê
       ‚Üì
LLM: generate_response() ‚Üí —Ç–µ–∫—Å—Ç
       ‚Üì
–ö–û–î: —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ (–≤—ã—Ä–µ–∑–∞–µ—Ç ? –µ—Å–ª–∏ –∑–∞–ø—Ä–µ—â–µ–Ω–æ)
       ‚Üì
–û—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É
```

### –î–µ—Ç–µ–∫—Ç–æ—Ä—ã (–ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –∫–æ–¥–µ)

| –î–µ—Ç–µ–∫—Ç–æ—Ä | –ß—Ç–æ –ª–æ–≤–∏—Ç |
|----------|-----------|
| `IRRITATED_PATTERNS` | –†–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ |
| `SEND_PATTERNS` | –ü—Ä–æ—Å—å–±—ã "—Å–∫–∏–Ω—å –≤–∞—Ä–∏–∞–Ω—Ç—ã" |
| `CALL_REJECT_PATTERNS` | –û—Ç–∫–∞–∑—ã –æ—Ç —Å–æ–∑–≤–æ–Ω–∞ |
| `NEUTRAL_PATTERNS` | –û—Ç–≤–µ—Ç—ã "–±–µ–∑ —Ä–∞–∑–Ω–∏—Ü—ã" |
| `CALL_AGREE_PATTERNS` | –°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ —Å–æ–∑–≤–æ–Ω |

**‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê:** –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Å–µ–π—á–∞—Å ‚Äî –¥–æ–≥–∞–¥–∫–∏, –Ω–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤!

### –ñ—ë—Å—Ç–∫–∏–µ –ª–∏–º–∏—Ç—ã

| –£—Å–ª–æ–≤–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ |
|---------|----------|
| –†–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ | ‚Üí SEND_MATERIALS, –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤ |
| 2+ —Ä–∞–∑ "—Å–∫–∏–Ω—å" | ‚Üí SEND_MATERIALS, –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤ |
| 14+ —Å–æ–æ–±—â–µ–Ω–∏–π | ‚Üí SEND_MATERIALS, –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤ |
| 2+ –æ—Ç–∫–∞–∑–∞ –æ—Ç —Å–æ–∑–≤–æ–Ω–∞ | ‚Üí SEND_MATERIALS, –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤ |
| 3+ "–±–µ–∑ —Ä–∞–∑–Ω–∏—Ü—ã" | ‚Üí SEND_MATERIALS, –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤ |

### –§–∞–π–ª—ã

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|
| `sofia_hybrid.py` | –õ–æ–≥–∏–∫–∞: –¥–µ—Ç–µ–∫—Ç–æ—Ä—ã, –∞–Ω–∞–ª–∏–∑, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è |
| `bot_server_hybrid.py` | Telegram –±–æ—Ç |
| `sofia_prompt.py` | –ü—Ä–æ–º–ø—Ç v4.1 |
| `scripts/dialog_processor.py` | –ü–∞—Ä—Å–∏–Ω–≥ + LLM-–æ—Ü–µ–Ω–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤ |
| `scripts/batch_process.py` | –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ |

---

## ‚öôÔ∏è –£–ü–†–ê–í–õ–ï–ù–ò–ï
```bash
# –°—Ç–∞—Ç—É—Å
systemctl status sofia-hybrid

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
systemctl restart sofia-hybrid

# –õ–æ–≥–∏
journalctl -u sofia-hybrid -f

# –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (–≤ –±–æ—Ç–µ)
/model gpt-5.2-reasoning
```

---

## üìä –ú–ï–¢–†–ò–ö–ò

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –¶–µ–ª—å |
|---------|----------|------|
| GOOD rate | 57% | 80% |
| –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è | 3.1/10 | ‚â•7 |
| –ó–∞–∫—Ä—ã—Ç–∏–µ | 6.1/10 | ‚â•7 |

---

## üìù TASKS

### üî• –°–µ–π—á–∞—Å ‚Äî –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- [ ] –ü—Ä–æ–≥–Ω–∞—Ç—å 49 –¥–∏–∞–ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ batch_process.py
- [ ] –ò–∑–≤–ª–µ—á—å —Ä–µ–∞–ª—å–Ω—ã–µ —Ñ—Ä–∞–∑—ã ‚Üí –æ–±–Ω–æ–≤–∏—Ç—å –¥–µ—Ç–µ–∫—Ç–æ—Ä—ã
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### ‚úÖ –°–¥–µ–ª–∞–Ω–æ (2025-12-29)
- [x] –ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ v2.1
- [x] GPT-5.2-reasoning –ø–æ–¥–∫–ª—é—á–µ–Ω
- [x] –ü—Ä–æ–º–ø—Ç v4.1 –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
- [x] –§–∞–π–ª—ã –≤ GitHub

---

## üìú CHANGELOG

### v2.1 (2025-12-29)
- –ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: –∫–æ–¥ + LLM
- –î–µ—Ç–µ–∫—Ç–æ—Ä—ã –∏ –∂—ë—Å—Ç–∫–∏–µ –ª–∏–º–∏—Ç—ã
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
- –§–∞–π–ª—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ GitHub

---

## üîÑ HANDOFF

> –°–µ—Å—Å–∏—è: 2025-12-29

### –ß—Ç–æ —Å–¥–µ–ª–∞–ª–∏
- –†–∞–∑–≤–µ—Ä–Ω—É–ª–∏ –≥–∏–±—Ä–∏–¥–Ω—É—é —Å–∏—Å—Ç–µ–º—É v2.1
- –ü–æ–¥–∫–ª—é—á–∏–ª–∏ GPT-5.2-reasoning
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–ª–∏ –ø—Ä–æ–º–ø—Ç v4.1
- –î–æ–±–∞–≤–∏–ª–∏ —Ñ–∞–π–ª—ã –≤ GitHub

### –ü—Ä–æ–±–ª–µ–º—ã
- –ü–∞—Ç—Ç–µ—Ä–Ω—ã ‚Äî –¥–æ–≥–∞–¥–∫–∏, –Ω–µ –¥–∞–Ω–Ω—ã–µ
- –ë–æ—Ç –∏–Ω–æ–≥–¥–∞ –∑–∞–¥–∞—ë—Ç 2 –≤–æ–ø—Ä–æ—Å–∞
- –î–µ—Ç–µ–∫—Ç–æ—Ä –Ω–µ –ª–æ–≤–∏—Ç "–∑–∞—á–µ–º –≤—ã..."

### –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥
**–ò–∑–≤–ª–µ—á—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ 49 –¥–∏–∞–ª–æ–≥–æ–≤:**
```bash
python scripts/batch_process.py ~/dialogs/ --llm
```
–û–±–Ω–æ–≤–∏—Ç—å –≤ `sofia_hybrid.py`:
- IRRITATED_PATTERNS
- SEND_PATTERNS
- CALL_REJECT_PATTERNS
- NEUTRAL_PATTERNS

### –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏
```
/Users/sergeysemiekhin/human bot/–¥–∏–∞–ª–æ–≥–∏/
```

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-12-29*
